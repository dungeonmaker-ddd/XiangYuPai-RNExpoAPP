# ğŸ—ºï¸ Profile Routing Architecture - ä¸ªäººä¸»é¡µè·¯ç”±æ¶æ„

## ğŸ¯ è·¯ç”±è®¾è®¡åŸåˆ™

### âœ… æ­£ç¡®çš„è·¯ç”±æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Profile è·¯ç”±ç³»ç»Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1ï¸âƒ£ è‡ªå·±çš„ä¸»é¡µï¼ˆOwn Profileï¼‰                               â”‚
â”‚     Route: /(tabs)/profile (æ—  userId å‚æ•°)                 â”‚
â”‚     Component: Profile/MainPage                            â”‚
â”‚     ç”¨é€”: æŸ¥çœ‹å’Œç¼–è¾‘è‡ªå·±çš„ä¸ªäººèµ„æ–™                            â”‚
â”‚                                                             â”‚
â”‚  2ï¸âƒ£ å…¶ä»–äººçš„ä¸»é¡µï¼ˆOther User's Profileï¼‰                    â”‚
â”‚     Route: /profile/[userId]                               â”‚
â”‚     Component: Profile/OtherUserProfilePage                â”‚
â”‚     ç”¨é€”: æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„å®Œæ•´ä¸ªäººèµ„æ–™                          â”‚
â”‚                                                             â”‚
â”‚  3ï¸âƒ£ å¿«é€Ÿé¢„è§ˆæ¨¡æ€æ¡†ï¼ˆQuick Preview Modalï¼‰                   â”‚
â”‚     Route: /modal/user-detail                              â”‚
â”‚     Component: Homepage/UserDetailFlow/EnhancedUserDetailPageâ”‚
â”‚     ç”¨é€”: é¦–é¡µç”¨æˆ·å¡ç‰‡çš„å¿«é€Ÿé¢„è§ˆ                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ç”¨æˆ·äº¤äº’æµç¨‹

### åœºæ™¯ 1ï¼šä»é¦–é¡µæŸ¥çœ‹å…¶ä»–ç”¨æˆ·

```
ç”¨æˆ·åœ¨é¦–é¡µ
    â†“
ç‚¹å‡»ç”¨æˆ·å¡ç‰‡
    â†“
ğŸ“± æ‰“å¼€å¿«é€Ÿé¢„è§ˆæ¨¡æ€æ¡†
   /modal/user-detail?userId=xxx
   (EnhancedUserDetailPage)
   
   æ˜¾ç¤ºï¼š
   - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
   - å¿«é€Ÿæ“ä½œæŒ‰é’®ï¼ˆå…³æ³¨ã€æ¶ˆæ¯ï¼‰
   - "æŸ¥çœ‹å®Œæ•´ä¸»é¡µ" æŒ‰é’®
    â†“
ç‚¹å‡» "æŸ¥çœ‹å®Œæ•´ä¸»é¡µ"
    â†“
âœ… è·³è½¬åˆ°å®Œæ•´ä¸ªäººä¸»é¡µ
   /profile/[userId]
   (OtherUserProfilePage)
   
   æ˜¾ç¤ºï¼š
   - å®Œæ•´çš„ç”¨æˆ·èµ„æ–™
   - åŠ¨æ€åˆ—è¡¨
   - æ”¶è—ã€ç‚¹èµç­‰
   - æ‰€æœ‰åŠŸèƒ½å¡ç‰‡
```

### åœºæ™¯ 2ï¼šæŸ¥çœ‹è‡ªå·±çš„ä¸»é¡µ

```
ç”¨æˆ·ç‚¹å‡»åº•éƒ¨ Tab "ä¸ªäºº"
    â†“
âœ… æ˜¾ç¤ºè‡ªå·±çš„ä¸»é¡µ
   /(tabs)/profile (æ—  userId)
   (Profile/MainPage)
   
   åŠŸèƒ½ï¼š
   - æŸ¥çœ‹è‡ªå·±çš„èµ„æ–™
   - ç¼–è¾‘ä¸ªäººä¿¡æ¯
   - ç®¡ç†åŠ¨æ€ã€æ”¶è—ç­‰
   - æŸ¥çœ‹ç²‰ä¸/å…³æ³¨
```

### åœºæ™¯ 3ï¼šä»å…¶ä»–åœ°æ–¹è®¿é—®ç”¨æˆ·ä¸»é¡µ

```
å„ç§å…¥å£ï¼ˆå‘ç°é¡µã€æ¶ˆæ¯é¡µã€è¯„è®ºç­‰ï¼‰
    â†“
ç‚¹å‡»ç”¨æˆ·å¤´åƒ/æ˜µç§°
    â†“
âœ… ç›´æ¥è·³è½¬åˆ°å®Œæ•´ä¸»é¡µ
   /profile/[userId]
   (OtherUserProfilePage)
```

## ğŸ› ä¹‹å‰çš„é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰

### âŒ é”™è¯¯çš„è·¯ç”±ï¼ˆä¿®å¤å‰ï¼‰

```typescript
// EnhancedUserDetailPage.tsx - ä¿®å¤å‰
const handleViewFullProfile = useCallback(() => {
  router.push({
    pathname: '/(tabs)/profile',  // âŒ é”™è¯¯ï¼è¿™æ˜¯è‡ªå·±çš„ä¸»é¡µ
    params: { userId },
  });
}, [userId, router]);

é—®é¢˜ï¼š
- è·³è½¬åˆ° tab profile é¡µé¢
- ä½¿ç”¨äº† MainPage ç»„ä»¶ï¼ˆè®¾è®¡ç”¨äºè‡ªå·±çš„ä¸»é¡µï¼‰
- å¯¼è‡´ UI å’ŒåŠŸèƒ½ä¸åŒ¹é…
- å¯èƒ½ä¼šæ˜¾ç¤ºç¼–è¾‘æŒ‰é’®ç­‰ä¸åº”è¯¥å‡ºç°çš„åŠŸèƒ½
```

### âœ… æ­£ç¡®çš„è·¯ç”±ï¼ˆä¿®å¤åï¼‰

```typescript
// EnhancedUserDetailPage.tsx - ä¿®å¤å
const handleViewFullProfile = useCallback(() => {
  router.push({
    pathname: '/profile/[userId]',  // âœ… æ­£ç¡®ï¼å…¶ä»–ç”¨æˆ·ä¸»é¡µ
    params: { userId },
  });
}, [userId, router]);

ä¼˜ç‚¹ï¼š
- è·³è½¬åˆ°ä¸“ç”¨çš„å…¶ä»–ç”¨æˆ·ä¸»é¡µ
- ä½¿ç”¨ OtherUserProfilePage ç»„ä»¶
- UI å’ŒåŠŸèƒ½å®Œå…¨åŒ¹é…
- åªæ˜¾ç¤ºæŸ¥çœ‹ç›¸å…³çš„åŠŸèƒ½ï¼ˆå…³æ³¨ã€æ¶ˆæ¯ç­‰ï¼‰
```

## ğŸ“‚ æ–‡ä»¶ç»“æ„æ˜ å°„

```
app/
â”œâ”€â”€ (tabs)/
â”‚   â””â”€â”€ profile.tsx                    â†’ Profile/MainPage
â”‚       Route: /(tabs)/profile
â”‚       ç”¨é€”: è‡ªå·±çš„ä¸»é¡µ
â”‚       æ—  userId å‚æ•°æ—¶ï¼šæ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„ä¸»é¡µ
â”‚       
â”œâ”€â”€ profile/
â”‚   â””â”€â”€ [userId].tsx                   â†’ Profile/OtherUserProfilePage
â”‚       Route: /profile/[userId]
â”‚       ç”¨é€”: å…¶ä»–ç”¨æˆ·çš„å®Œæ•´ä¸»é¡µ
â”‚       å¿…é¡»æœ‰ userId å‚æ•°
â”‚       
â””â”€â”€ modal/
    â””â”€â”€ user-detail.tsx                â†’ EnhancedUserDetailPage
        Route: /modal/user-detail
        ç”¨é€”: å¿«é€Ÿé¢„è§ˆæ¨¡æ€æ¡†
        ä»é¦–é¡µç”¨æˆ·å¡ç‰‡ç‚¹å‡»è¿›å…¥

src/features/
â”œâ”€â”€ Profile/
â”‚   â”œâ”€â”€ MainPage/                      è‡ªå·±çš„ä¸»é¡µç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ BackgroundArea/
â”‚   â”‚   â”œâ”€â”€ UserInfoArea/
â”‚   â”‚   â”œâ”€â”€ SocialStatsArea/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ OtherUserProfilePage/          å…¶ä»–ç”¨æˆ·ä¸»é¡µç»„ä»¶
â”‚       â”œâ”€â”€ index.tsx
â”‚       â”œâ”€â”€ HeaderArea/
â”‚       â”œâ”€â”€ ProfileInfoArea/
â”‚       â”œâ”€â”€ StatsArea/
â”‚       â”œâ”€â”€ TabArea/
â”‚       â”œâ”€â”€ ContentArea/
â”‚       â”œâ”€â”€ ActionButtonsArea/
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ Homepage/
    â””â”€â”€ UserDetailFlow/
        â””â”€â”€ EnhancedUserDetailPage.tsx å¿«é€Ÿé¢„è§ˆæ¨¡æ€æ¡†
```

## ğŸ¨ ç»„ä»¶å¯¹æ¯”

### Profile/MainPageï¼ˆè‡ªå·±çš„ä¸»é¡µï¼‰

**ç”¨é€”ï¼š** å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¸»é¡µ

**ç‰¹ç‚¹ï¼š**
- âœ… å¯ä»¥ç¼–è¾‘ä¸ªäººä¿¡æ¯
- âœ… æ˜¾ç¤ºç¼–è¾‘æŒ‰é’®
- âœ… ç®¡ç†è‡ªå·±çš„å†…å®¹
- âœ… æŸ¥çœ‹ç§å¯†æ•°æ®
- âœ… è®¾ç½®åŠŸèƒ½

**è·¯ç”±ï¼š** `/(tabs)/profile`

**ç¤ºä¾‹ï¼š**
```typescript
// æ— å‚æ•°ï¼Œæ˜¾ç¤ºå½“å‰ç”¨æˆ·
<MainPage />

// è¿™ä¸ªç”¨æ³•æ˜¯é”™è¯¯çš„ï¼ä¸åº”è¯¥ä¼ å…¥å…¶ä»–ç”¨æˆ·ID
<MainPage userId="other-user-id" /> // âŒ ä¸æ¨è
```

### Profile/OtherUserProfilePageï¼ˆå…¶ä»–ç”¨æˆ·ä¸»é¡µï¼‰

**ç”¨é€”ï¼š** æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„ä¸ªäººä¸»é¡µ

**ç‰¹ç‚¹ï¼š**
- âœ… åªè¯»æ¨¡å¼ï¼ˆä¸èƒ½ç¼–è¾‘ï¼‰
- âœ… æ˜¾ç¤ºå…³æ³¨æŒ‰é’®
- âœ… æ˜¾ç¤ºå‘æ¶ˆæ¯æŒ‰é’®
- âœ… æ˜¾ç¤ºç”¨æˆ·å…¬å¼€ä¿¡æ¯
- âœ… æŸ¥çœ‹ç”¨æˆ·åŠ¨æ€
- âŒ æ²¡æœ‰ç¼–è¾‘åŠŸèƒ½
- âŒ ä¸æ˜¾ç¤ºç§å¯†æ•°æ®

**è·¯ç”±ï¼š** `/profile/[userId]`

**ç¤ºä¾‹ï¼š**
```typescript
// å¿…é¡»ä¼ å…¥ç”¨æˆ·ID
<OtherUserProfilePage userId="other-user-id" /> // âœ… æ­£ç¡®
```

### EnhancedUserDetailPageï¼ˆå¿«é€Ÿé¢„è§ˆï¼‰

**ç”¨é€”ï¼š** é¦–é¡µç”¨æˆ·å¡ç‰‡çš„å¿«é€Ÿé¢„è§ˆ

**ç‰¹ç‚¹ï¼š**
- âœ… æ¨¡æ€æ¡†å½¢å¼
- âœ… æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
- âœ… å¿«é€Ÿæ“ä½œï¼ˆå…³æ³¨ã€æ¶ˆæ¯ï¼‰
- âœ… "æŸ¥çœ‹å®Œæ•´ä¸»é¡µ" æŒ‰é’®
- âœ… è½»é‡çº§ï¼ŒåŠ è½½å¿«

**è·¯ç”±ï¼š** `/modal/user-detail`

**è·³è½¬åˆ°å®Œæ•´ä¸»é¡µï¼š**
```typescript
// âœ… æ­£ç¡®ï¼šè·³è½¬åˆ° OtherUserProfilePage
router.push({
  pathname: '/profile/[userId]',
  params: { userId },
});
```

## ğŸ”§ ä¿®å¤çš„æ–‡ä»¶

### 1. EnhancedUserDetailPage.tsx

**ä¿®æ”¹ï¼š** `handleViewFullProfile` å‡½æ•°

**Before:**
```typescript
const handleViewFullProfile = useCallback(() => {
  router.push({
    pathname: '/(tabs)/profile',  // âŒ
    params: { userId },
  });
}, [userId, router]);
```

**After:**
```typescript
const handleViewFullProfile = useCallback(() => {
  router.push({
    pathname: '/profile/[userId]',  // âœ…
    params: { userId },
  });
}, [userId, router]);
```

### 2. Homepage/MainPage/MainPage.tsx

**ä¿®æ”¹ï¼š** `handleViewUserProfile` å‡½æ•°

**Before:**
```typescript
const handleViewUserProfile = useCallback((userId: string) => {
  console.log('[MainPage] ğŸ§­ å¯¼èˆª: é¦–é¡µ â†’ ä¸ªäººä¸»é¡µ', { userId });
  router.push({
    pathname: '/(tabs)/profile',  // âŒ
    params: { userId },
  });
}, [router]);
```

**After:**
```typescript
const handleViewUserProfile = useCallback((userId: string) => {
  console.log('[MainPage] ğŸ§­ å¯¼èˆª: é¦–é¡µ â†’ å…¶ä»–ç”¨æˆ·ä¸»é¡µ', { userId });
  router.push({
    pathname: '/profile/[userId]',  // âœ…
    params: { userId },
  });
}, [router]);
```

## ğŸ§ª æµ‹è¯•åœºæ™¯

### âœ… æµ‹è¯• 1: æŸ¥çœ‹å…¶ä»–ç”¨æˆ·å®Œæ•´ä¸»é¡µ

```
æ­¥éª¤ï¼š
1. åœ¨é¦–é¡µç‚¹å‡»ä»»æ„ç”¨æˆ·å¡ç‰‡
2. åœ¨æ¨¡æ€æ¡†ä¸­ç‚¹å‡» "æŸ¥çœ‹å®Œæ•´ä¸»é¡µ"
3. åº”è¯¥çœ‹åˆ°å®Œæ•´çš„ç”¨æˆ·ä¸»é¡µï¼ˆOtherUserProfilePageï¼‰
4. åº”è¯¥çœ‹åˆ°ï¼š
   - ç”¨æˆ·å¤´åƒå’Œèµ„æ–™
   - å…³æ³¨/å‘æ¶ˆæ¯æŒ‰é’®åœ¨åº•éƒ¨
   - åŠ¨æ€ã€èµ„æ–™ã€æŠ€èƒ½ç­‰ Tab
   - ä¸åº”è¯¥æœ‰ç¼–è¾‘æŒ‰é’®

é¢„æœŸï¼šâœ… ä½¿ç”¨ OtherUserProfilePage ç»„ä»¶
```

### âœ… æµ‹è¯• 2: æŸ¥çœ‹è‡ªå·±çš„ä¸»é¡µ

```
æ­¥éª¤ï¼š
1. ç‚¹å‡»åº•éƒ¨ Tab "ä¸ªäºº"
2. åº”è¯¥çœ‹åˆ°è‡ªå·±çš„ä¸»é¡µï¼ˆMainPageï¼‰
3. åº”è¯¥çœ‹åˆ°ï¼š
   - å¯ä»¥ç¼–è¾‘çš„èµ„æ–™
   - ç¼–è¾‘æŒ‰é’®
   - å®Œæ•´çš„åŠŸèƒ½è®¿é—®

é¢„æœŸï¼šâœ… ä½¿ç”¨ MainPage ç»„ä»¶
```

### âœ… æµ‹è¯• 3: æœªç™»å½•è®¿é—®è‡ªå·±çš„ä¸»é¡µ

```
æ­¥éª¤ï¼š
1. é€€å‡ºç™»å½•
2. ç‚¹å‡»åº•éƒ¨ Tab "ä¸ªäºº"
3. åº”è¯¥è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

é¢„æœŸï¼šâœ… é‡å®šå‘åˆ° /auth/login
```

## ğŸ“Š è·¯ç”±å†³ç­–è¡¨

| åœºæ™¯ | è·¯ç”± | ç»„ä»¶ | ç”¨é€” |
|------|------|------|------|
| æŸ¥çœ‹è‡ªå·±çš„ä¸»é¡µ | `/(tabs)/profile` | `Profile/MainPage` | ç¼–è¾‘å’Œç®¡ç†è‡ªå·±çš„èµ„æ–™ |
| æŸ¥çœ‹å…¶ä»–ç”¨æˆ·ä¸»é¡µ | `/profile/[userId]` | `Profile/OtherUserProfilePage` | æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„å®Œæ•´èµ„æ–™ |
| é¦–é¡µå¿«é€Ÿé¢„è§ˆ | `/modal/user-detail` | `EnhancedUserDetailPage` | å¿«é€ŸæŸ¥çœ‹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ |

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ°¸è¿œä¸è¦æ··ç”¨è·¯ç”±

```typescript
// âŒ é”™è¯¯ï¼šå°†å…¶ä»–ç”¨æˆ·IDä¼ ç»™è‡ªå·±çš„ä¸»é¡µ
router.push({
  pathname: '/(tabs)/profile',
  params: { userId: 'other-user-id' },
});

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ä¸“ç”¨çš„å…¶ä»–ç”¨æˆ·ä¸»é¡µè·¯ç”±
router.push({
  pathname: '/profile/[userId]',
  params: { userId: 'other-user-id' },
});
```

### 2. ä»ä»»ä½•åœ°æ–¹æŸ¥çœ‹ç”¨æˆ·ä¸»é¡µçš„æ ‡å‡†æ–¹å¼

```typescript
// é€šç”¨å‡½æ•°ï¼šæ™ºèƒ½è·¯ç”±åˆ°æ­£ç¡®çš„ä¸»é¡µ
const navigateToUserProfile = (userId: string, currentUserId: string) => {
  if (userId === currentUserId) {
    // æŸ¥çœ‹è‡ªå·±çš„ä¸»é¡µ
    router.push('/(tabs)/profile');
  } else {
    // æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„ä¸»é¡µ
    router.push({
      pathname: '/profile/[userId]',
      params: { userId },
    });
  }
};
```

### 3. ç»„ä»¶é€‰æ‹©é€»è¾‘

```
éœ€è¦æŸ¥çœ‹ç”¨æˆ·ä¸»é¡µæ—¶ï¼Œé—®è‡ªå·±ï¼š

1. æ˜¯è‡ªå·±çš„ä¸»é¡µå—ï¼Ÿ
   âœ… Yes â†’ ä½¿ç”¨ /(tabs)/profile (MainPage)
   âŒ No  â†’ ç»§ç»­ä¸‹ä¸€æ­¥

2. éœ€è¦å®Œæ•´åŠŸèƒ½å—ï¼Ÿ
   âœ… Yes â†’ ä½¿ç”¨ /profile/[userId] (OtherUserProfilePage)
   âŒ No  â†’ ä½¿ç”¨ /modal/user-detail (å¿«é€Ÿé¢„è§ˆ)

3. å·²ç»åœ¨æ¨¡æ€æ¡†ä¸­ï¼Œæƒ³çœ‹å®Œæ•´çš„ï¼Ÿ
   âœ… Yes â†’ å…³é—­æ¨¡æ€æ¡†ï¼Œè·³è½¬åˆ° /profile/[userId]
```

## âœ… ä¿®å¤éªŒè¯æ¸…å•

- [x] ä¿®å¤ EnhancedUserDetailPage çš„è·¯ç”±
- [x] ä¿®å¤ Homepage MainPage çš„è·¯ç”±
- [x] åˆ›å»ºè·¯ç”±æ¶æ„æ–‡æ¡£
- [ ] æµ‹è¯•ï¼šä»é¦–é¡µæ¨¡æ€æ¡†è·³è½¬åˆ°å®Œæ•´ä¸»é¡µ
- [ ] æµ‹è¯•ï¼šç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„ç»„ä»¶ï¼ˆOtherUserProfilePageï¼‰
- [ ] æµ‹è¯•ï¼šç¡®è®¤ UI å’ŒåŠŸèƒ½æ­£ç¡®æ˜¾ç¤º

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **OtherUserProfilePage æ¶æ„ï¼š** `src/features/Profile/OtherUserProfilePage/ARCHITECTURE_DESIGN.md`
- **MainPage æ–‡æ¡£ï¼š** `src/features/Profile/MainPage/QUICK_REFERENCE.md`
- **è·¯ç”±é…ç½®ï¼š** `app/_layout.tsx`

---

**ä¿®å¤æ—¥æœŸï¼š** 2025-10-27  
**ç‰ˆæœ¬ï¼š** v1.0  
**çŠ¶æ€ï¼š** âœ… å·²ä¿®å¤å¹¶æ–‡æ¡£åŒ–

**ç°åœ¨è·¯ç”±æ¶æ„æ¸…æ™°ä¸”ä¸€è‡´äº†ï¼** ğŸ‰

