# ğŸ¯ Profile + Authæ•°æ® - å¿«é€Ÿå‚è€ƒå¡

> **ä¸€é¡µé€ŸæŸ¥** | æœ€åæ›´æ–°: 2025-10-28

---

## ğŸ“Š ä¸¤å±‚æ•°æ®æ¶æ„

```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  authStore.userInfo (åŸºç¡€èº«ä»½ - 5å­—æ®µ)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… ç”¨é€”: èº«ä»½è¯†åˆ«ã€åŸºç¡€æ˜¾ç¤º                             â”‚
â”‚  âœ… æ¥æº: ç™»å½•æ—¶ä¿å­˜                                     â”‚
â”‚  âœ… ç‰¹ç‚¹: è½»é‡ã€å¿«é€Ÿã€å·²åœ¨å†…å­˜                           â”‚
â”‚                                                          â”‚
â”‚  id: string           â† ç”¨æˆ·ID                           â”‚
â”‚  phone: string        â† æ‰‹æœºå·                           â”‚
â”‚  nickname: string     â† æ˜µç§°                             â”‚
â”‚  avatar: string       â† å¤´åƒ                             â”‚
â”‚  verified: boolean    â† è®¤è¯çŠ¶æ€                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  profileStore.currentProfile (å®Œæ•´èµ„æ–™ - 42å­—æ®µ)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… ç”¨é€”: è¯¦ç»†èµ„æ–™ã€ç»Ÿè®¡æ•°æ®                             â”‚
â”‚  âœ… æ¥æº: APIåŠ è½½                                        â”‚
â”‚  âœ… ç‰¹ç‚¹: å®Œæ•´ã€ä¸°å¯Œã€éœ€è¦è°ƒç”¨API                        â”‚
â”‚                                                          â”‚
â”‚  id, nickname, avatar                                   â”‚
â”‚  + gender, age, location, bio                           â”‚
â”‚  + height, weight, occupations                          â”‚
â”‚  + isRealVerified, isOnline                             â”‚
â”‚  + followingCount, followerCount, likeCount             â”‚
â”‚  + ... (å…±42ä¸ªå­—æ®µ)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ä½¿ç”¨å†³ç­–æ ‘

### æˆ‘éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Ÿ

```
éœ€è¦ç”¨æˆ·ID?
    â”œâ”€ YES â†’ authStore.userInfo.id âš¡
    â””â”€ NO â†“

éœ€è¦æ‰‹æœºå·?
    â”œâ”€ YES â†’ authStore.userInfo.phone âš¡
    â””â”€ NO â†“

éœ€è¦åŸºç¡€æ˜µç§°/å¤´åƒ?
    â”œâ”€ YES â†’ authStore.userInfo.nickname/avatar âš¡
    â””â”€ NO â†“

éœ€è¦ä½ç½®/èº«é«˜/å…³æ³¨æ•°/å®Œæ•´èµ„æ–™?
    â””â”€ YES â†’ profileStore.currentProfile ğŸ“¦
```

**âš¡ = å·²åœ¨å†…å­˜ï¼Œæ— éœ€APIè°ƒç”¨**  
**ğŸ“¦ = éœ€è¦APIåŠ è½½**

---

## ğŸ’» ä»£ç é€ŸæŸ¥

### 1ï¸âƒ£ è·å–å½“å‰ç”¨æˆ·ID

```typescript
import { useAuthStore } from '@/stores/authStore';

// âœ… æ¨èï¼šä½¿ç”¨authStore
const userId = useAuthStore(state => state.userInfo?.id);
```

---

### 2ï¸âƒ£ åŠ è½½ç”¨æˆ·èµ„æ–™

```typescript
import { useProfileStore } from '@/stores/profileStore';

const loadUserProfile = useProfileStore(state => state.loadUserProfile);

// âœ… åŠ è½½å½“å‰ç”¨æˆ·ï¼ˆè‡ªåŠ¨ä½¿ç”¨authStore.userInfo.idï¼‰
await loadUserProfile();

// âœ… åŠ è½½å…¶ä»–ç”¨æˆ·
await loadUserProfile('123456');
```

---

### 3ï¸âƒ£ åˆ¤æ–­æ˜¯å¦æœ¬äººä¸»é¡µ

```typescript
import { useProfileData } from '@/src/features/Profile/MainPage/hooks/useProfileData';

const { isOwnProfile } = useProfileData({ userId });

if (isOwnProfile) {
  return <EditButton />;
} else {
  return <FollowButton />;
}
```

---

### 4ï¸âƒ£ è·å–åŸºç¡€ä¿¡æ¯ vs å®Œæ•´èµ„æ–™

```typescript
import { useAuthStore } from '@/stores/authStore';
import { useProfileStore } from '@/stores/profileStore';

// âœ… åŸºç¡€ä¿¡æ¯ï¼ˆå¿«é€Ÿï¼‰
const authUserInfo = useAuthStore(state => state.userInfo);
console.log(authUserInfo.id);      // ç”¨æˆ·ID
console.log(authUserInfo.phone);   // æ‰‹æœºå·

// âœ… å®Œæ•´èµ„æ–™ï¼ˆéœ€è¦åŠ è½½ï¼‰
const fullProfile = useProfileStore(state => state.currentProfile);
console.log(fullProfile.location);        // ä½ç½®
console.log(fullProfile.followingCount);  // å…³æ³¨æ•°
```

---

### 5ï¸âƒ£ ä½¿ç”¨useProfileData Hook

```typescript
import { useProfileData } from '@/src/features/Profile/MainPage/hooks/useProfileData';

const {
  authUserInfo,       // åŸºç¡€ä¿¡æ¯ï¼ˆæ¥è‡ªauthStoreï¼‰
  currentProfile,     // å®Œæ•´èµ„æ–™ï¼ˆæ¥è‡ªprofileStoreï¼‰
  isOwnProfile,       // æ˜¯å¦æœ¬äººä¸»é¡µ
  isProfileReady,     // æ˜¯å¦å°±ç»ª
} = useProfileData();

if (!isProfileReady) return <Loading />;

return (
  <View>
    <Text>ID: {authUserInfo?.id}</Text>
    <Text>æ‰‹æœº: {authUserInfo?.phone}</Text>
    <Text>ä½ç½®: {currentProfile?.location}</Text>
  </View>
);
```

---

## ğŸš¦ å¸¸è§åœºæ™¯

### åœºæ™¯1: ç‚¹èµ/è¯„è®ºéœ€è¦ç”¨æˆ·ID

```typescript
import { useAuthStore } from '@/stores/authStore';

function handleLike() {
  const userId = useAuthStore.getState().userInfo?.id;
  
  if (!userId) {
    router.push('/auth/login');
    return;
  }
  
  likePost(postId, userId);
}
```

---

### åœºæ™¯2: æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯

```typescript
import { useAuthStore } from '@/stores/authStore';

// âœ… åªéœ€è¦æ˜µç§°å’Œå¤´åƒ
const { nickname, avatar } = useAuthStore(state => state.userInfo || {});

return (
  <View>
    <Image source={{ uri: avatar }} />
    <Text>{nickname}</Text>
  </View>
);
```

---

### åœºæ™¯3: å®Œæ•´ä¸ªäººä¸»é¡µ

```typescript
import { useProfileStore } from '@/stores/profileStore';
import { useProfileData } from '@/hooks/useProfileData';

function ProfilePage() {
  const loadUserProfile = useProfileStore(state => state.loadUserProfile);
  const { currentProfile, isProfileReady } = useProfileData();
  
  useEffect(() => {
    loadUserProfile();  // è‡ªåŠ¨ä½¿ç”¨authStore.userInfo.id
  }, []);
  
  if (!isProfileReady) return <ProfileSkeleton />;
  
  return <FullProfileView profile={currentProfile} />;
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### âœ… DOï¼ˆæ¨èï¼‰

```typescript
// âœ… ä½¿ç”¨authStoreè·å–IDï¼ˆå·²åœ¨å†…å­˜ï¼‰
const userId = useAuthStore(state => state.userInfo?.id);

// âœ… ä½¿ç”¨é€‰æ‹©å™¨é¿å…é‡æ¸²æŸ“
const nickname = useAuthStore(state => state.userInfo?.nickname);

// âœ… æ£€æŸ¥ç¼“å­˜é¿å…é‡å¤åŠ è½½
if (!currentProfile) {
  loadUserProfile();
}
```

### âŒ DON'Tï¼ˆé¿å…ï¼‰

```typescript
// âŒ ä¸ºäº†IDè€ŒåŠ è½½å®Œæ•´profile
const userId = useProfileStore(state => state.currentProfile?.id);

// âŒ æ¯æ¬¡æ¸²æŸ“éƒ½è°ƒç”¨
useEffect(() => {
  loadUserProfile();  // æ²¡æœ‰ä¾èµ–é¡¹æ£€æŸ¥ï¼
});

// âŒ é‡å¤è·å–ç›¸åŒæ•°æ®
const user1 = useAuthStore(state => state.userInfo);
const user2 = useAuthStore(state => state.userInfo);  // é‡å¤ï¼
```

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ•°æ®å‰ï¼Œé—®è‡ªå·±ï¼š

- [ ] æˆ‘åªéœ€è¦ç”¨æˆ·IDå—ï¼Ÿ â†’ ä½¿ç”¨ `authStore.userInfo.id`
- [ ] æˆ‘éœ€è¦æ‰‹æœºå·å—ï¼Ÿ â†’ ä½¿ç”¨ `authStore.userInfo.phone`
- [ ] æˆ‘éœ€è¦å®Œæ•´èµ„æ–™å—ï¼Ÿ â†’ ä½¿ç”¨ `profileStore.currentProfile`
- [ ] æˆ‘æ£€æŸ¥äº†è®¤è¯çŠ¶æ€å—ï¼Ÿ â†’ æ£€æŸ¥ `isAuthenticated`
- [ ] æˆ‘é¿å…é‡å¤APIè°ƒç”¨äº†å—ï¼Ÿ â†’ æ£€æŸ¥ç¼“å­˜
- [ ] æˆ‘ä½¿ç”¨äº†é€‰æ‹©å™¨å—ï¼Ÿ â†’ é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- ğŸ“– [AUTH_INTEGRATION_GUIDE.md](./AUTH_INTEGRATION_GUIDE.md) - å®Œæ•´é›†æˆæŒ‡å—
- âœ… [âœ…_AUTH_INTEGRATION_COMPLETE.md](./âœ…_AUTH_INTEGRATION_COMPLETE.md) - å®ŒæˆæŠ¥å‘Š
- ğŸ“Š [DATA_LOGIN_TO_MODULES.md](../AuthModule/DATA_LOGIN_TO_MODULES.md) - æ•°æ®æµå‘

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è·å–å½“å‰ç”¨æˆ·IDï¼Ÿ

```typescript
const userId = useAuthStore(state => state.userInfo?.id);
```

### Q: å¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ¬äººä¸»é¡µï¼Ÿ

```typescript
const { isOwnProfile } = useProfileData({ userId });
```

### Q: å¦‚ä½•é¿å…é‡å¤åŠ è½½ï¼Ÿ

```typescript
const { currentProfile } = useProfileStore();
if (!currentProfile) {
  loadUserProfile();  // åªåœ¨æ²¡æœ‰æ•°æ®æ—¶åŠ è½½
}
```

### Q: authStoreæœ‰ä»€ä¹ˆæ•°æ®ï¼Ÿ

```typescript
authStore.userInfo = {
  id: string,           // ç”¨æˆ·ID
  phone: string,        // æ‰‹æœºå·
  nickname: string,     // æ˜µç§°
  avatar: string,       // å¤´åƒ
  verified: boolean,    // è®¤è¯çŠ¶æ€
  createdAt: string,    // åˆ›å»ºæ—¶é—´
}
```

### Q: profileStoreæœ‰ä»€ä¹ˆæ•°æ®ï¼Ÿ

```typescript
profileStore.currentProfile = {
  id, nickname, avatar,        // åŸºç¡€ä¿¡æ¯
  gender, age, location, bio,  // è¯¦ç»†èµ„æ–™
  height, weight,              // èº«ä½“ä¿¡æ¯
  occupations,                 // èŒä¸šæ ‡ç­¾
  isRealVerified, isOnline,    // çŠ¶æ€
  followingCount, followerCount, likeCount,  // ç»Ÿè®¡
  // ... å…±42ä¸ªå­—æ®µ
}
```

---

**ğŸ’¡ è®°ä½ï¼šä¼˜å…ˆä½¿ç”¨ authStoreï¼Œåªåœ¨éœ€è¦å®Œæ•´èµ„æ–™æ—¶æ‰ä½¿ç”¨ profileStore**

---

**æœ€åæ›´æ–°**: 2025-10-28  
**ç»´æŠ¤è€…**: Development Team

