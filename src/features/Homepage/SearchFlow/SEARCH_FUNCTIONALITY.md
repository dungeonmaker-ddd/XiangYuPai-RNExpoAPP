# 搜索功能文档

## 概述

首页搜索功能已完善，提供了完整的搜索体验，包括搜索历史、热门搜索和分类搜索结果。

## 功能特点

### 1. 搜索入口
- 位置：首页顶部搜索框
- 点击后进入专门的搜索页面
- 自动聚焦，方便用户输入

### 2. 搜索前状态
- **搜索历史**：显示用户最近的搜索记录
  - 点击历史记录快速搜索
  - 长按删除单条历史
  - 一键清空所有历史
  
- **热门搜索**：展示当前热门搜索词
  - 显示热度标识（🔥）
  - 点击快速搜索

### 3. 搜索结果页面

搜索结果页面包含：
- **顶部搜索栏**：显示当前搜索关键词，可点击搜索按钮重新搜索，左侧返回按钮
- **Tab分类栏**：四个Tab快速切换

#### Tab分类
搜索结果分为四个Tab，用户可以快速切换：

1. **全部** - 混合显示所有类型的结果
   - 用户结果（前2条）
   - 下单结果（前2条）
   - 话题结果（前2条）

2. **用户** - 显示匹配的用户
   - 用户头像
   - 昵称
   - 标签（如"王者荣耀"）
   - 在线状态指示
   - 认证标识
   - 关注按钮

3. **下单** - 显示匹配的服务订单
   - 用户头像和昵称
   - 性别标签
   - 服务标题
   - 服务描述
   - 价格（金币/局）
   - 距离信息

4. **话题** - 显示匹配的话题
   - 话题图标
   - 话题标题
   - 话题描述
   - HOT标识（热门话题）

## 文件结构

```
SearchFlow/
├── SearchMainPage/
│   ├── index.tsx          # 搜索主页面（搜索框、历史、热门）
│   └── types.ts           # 类型定义
├── SearchResultsPage/
│   └── index.tsx          # 搜索结果页面（Tab分类结果）
└── SEARCH_FUNCTIONALITY.md # 本文档
```

## 组件说明

### SearchMainPage
主搜索页面，负责：
- 搜索输入框
- 搜索历史管理
- 热门搜索展示
- 搜索建议（开发中）
- 集成SearchResultsPage显示结果

### SearchResultsPage
搜索结果页面，负责：
- Tab导航栏（全部、用户、下单、话题）
- 不同类型的结果卡片展示
- 结果点击交互

## 数据流

1. 用户输入搜索关键词
2. 点击搜索或回车
3. 调用搜索API（当前使用模拟数据）
4. 显示SearchResultsPage
5. 用户可切换Tab查看不同类型结果
6. 点击结果跳转到详情页

## UI设计参考

### 用户Tab（图二）
- 卡片式布局
- 左侧头像，右侧信息
- 底部关注按钮
- 认证标识和在线状态

### 下单Tab（图三）
- 横向卡片布局
- 左侧缩略图，右侧详细信息
- 价格突出显示（红色）
- 距离信息（右上角）

### 话题Tab（图四）
- 简洁列表布局
- 左侧话题图标
- 右侧标题和描述
- HOT标签标识

## 待实现功能

1. **搜索建议**：输入时实时显示搜索建议
2. **真实API对接**：替换模拟数据为真实API调用
3. **搜索过滤**：添加更多筛选条件
4. **搜索排序**：支持按相关度、时间等排序
5. **无限滚动**：支持加载更多结果
6. **搜索统计**：记录搜索行为用于优化

## 使用示例

```typescript
// 在首页点击搜索框
<SearchBar onPress={() => router.push('/homepage/search')} />

// 搜索页面会自动加载
// 用户输入关键词后显示结果
// 结果页面支持Tab切换
```

## 注意事项

1. 搜索历史存储在本地，最多保存10条
2. 热门搜索数据需要定期更新
3. 搜索结果使用模拟数据，需要对接真实API
4. 图片使用占位图，需要替换为真实图片URL
5. 距离计算需要用户位置权限

## 更新日志

### 2024-11-09
- ✅ 创建SearchResultsPage组件
- ✅ 实现四个Tab（全部、用户、下单、话题）
- ✅ 设计并实现各类型结果卡片
- ✅ 集成到SearchMainPage
- ✅ 添加模拟数据
- ✅ 完善UI样式，参考设计图
- ✅ 优化搜索结果页面：在结果页面显示独立的搜索栏，隐藏重复的顶部导航
- ✅ 搜索结果页面现在包含：搜索栏 + Tab栏 + 结果列表

